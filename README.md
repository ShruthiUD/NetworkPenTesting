<h1>NETWORK PEN TESTING AND DEFENSE PROJECT</h1>



<b>Part 1 - Pen Test </b>

I started with the first stage of pen testing, i.e., Information Gathering, followed by reconnaissance to find vulnerabilities using Nessus and OWASP ZAP. Nessus provided CVEs and CVSS. Later, I used Metasploit and the exploit database to find relevant exploits for the discovered vulnerabilities. Enum4linux combines results from enum_shares and those that are seperately available on Metasploit. We can search for CVEs in Metasploit and use searchsploit with the Linux version number to identify its vulnerabilities. I attempted path traversal to check for critical pages. Hydra was employed to determine if the pre-password list contains any passwords for the usernames. Burpsuite was also used to try the set of passwords. Finally, I demonstrated how the access was gained and maintained, utilizing SFTP to navigate different folders to find a master file.

<br />
<br />
<!--
<b>Part 2 - Defense </b>


Used Wireshark to see the network packets traffic of the Metasploit ssh scanner search. We can also use the hex values of the payload.
Write Snort IDS rules according to the traffic. Example rules:

alert tcp any any -> 192.168.56.102 22 (content:"SSH-2.0")

It is also possible in Snort to replace the ‘alert’ with a ‘drop’ (and run in inline mode), 
hence causing SNORT to behave in a proactive IPS manner (not just passive IDS) and 
drop suspicious packets from reaching the target application/server.


IPS: IPTables

iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --set
iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 3600 --hitcount 3 -j LOG --log-prefix 'SSH-EVENT: ‘
iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 3600 --hitcount 3 -j DROP

iptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 1 -j REJECT

--syn means that the rule only looks at TCP packets with the syn flag - which indicates a new connection.
<br />
<br />

<p align="center">
<img src="https://i.imgur.com/3d3CEwZ.png" height="85%" width="85%" alt="RDP event fail logs to iP Geographic information"/>
</p>
<h2>Languages Used</h2>

- <b>PowerShell:</b> Extract RDP failed logon logs from Windows Event Viewer 

<h2>Utilities Used</h2>

- <b>ipgeolocation.io:</b> IP Address to Geolocation API

<h2>Attacks from China coming in; Custom logs being output with geodata</h2>

<p align="center">
<img src="https://i.imgur.com/LhDCRz4.jpeg" height="85%" width="85%" alt="Image Analysis Dataflow"/>
</p>

<h2>World map of incoming attacks after 24 hours (built custom logs including geodata)</h2>

<p align="center">
<img src="https://i.imgur.com/krRFrK5.png" height="85%" width="85%" alt="Image Analysis Dataflow"/>
</p>


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
